<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SolanaYield // Autonomous DeFi Intelligence</title>
  <meta property="og:title" content="SolanaYield - AI DeFi Yield Orchestrator">
  <meta property="og:description" content="Autonomous yield optimization across 9+ Solana DeFi protocols">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --neon-cyan: #00fff9;
      --neon-pink: #ff00ff;
      --neon-green: #39ff14;
      --neon-yellow: #ffff00;
      --neon-purple: #9945FF;
      --dark-bg: #0a0a0f;
      --darker-bg: #050508;
      --grid-color: rgba(0, 255, 249, 0.08);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: var(--dark-bg);
      color: #fff;
      font-family: 'JetBrains Mono', monospace;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Cyberpunk grid - perspective horizon with animation */
    .grid-bg {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200%;
      height: 80%;
      background-image: 
        linear-gradient(var(--grid-color) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
      background-size: 80px 80px;
      transform: perspective(400px) rotateX(65deg) translateZ(0);
      transform-origin: bottom center;
      z-index: -3;
      animation: gridScroll 20s linear infinite;
      margin-left: -50%;
    }

    @keyframes gridScroll {
      0% { background-position: 0 0; }
      100% { background-position: 0 80px; }
    }

    /* Horizon glow - removed per feedback, was obstructing content */

    /* Particle canvas */
    #particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    /* Floating orbs */
    .floating-orbs {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      overflow: hidden;
      pointer-events: none;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.15;
      animation: orbFloat 25s ease-in-out infinite;
    }

    .orb1 {
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, var(--neon-cyan) 0%, transparent 70%);
      top: -10%;
      left: -10%;
      animation-delay: 0s;
    }

    .orb2 {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, var(--neon-pink) 0%, transparent 70%);
      bottom: 10%;
      right: -5%;
      animation-delay: -8s;
      animation-duration: 30s;
    }

    .orb3 {
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, var(--neon-purple) 0%, transparent 70%);
      top: 40%;
      left: 60%;
      animation-delay: -15s;
      animation-duration: 35s;
    }

    @keyframes orbFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      25% { transform: translate(100px, 50px) scale(1.1); }
      50% { transform: translate(50px, -80px) scale(0.9); }
      75% { transform: translate(-70px, 30px) scale(1.05); }
    }

    /* Scanlines */
    .scanlines {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.15),
        rgba(0, 0, 0, 0.15) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      z-index: 1000;
    }

    /* Noise texture */
    .noise {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.03;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 999;
    }

    .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; position: relative; }

    /* Header */
    header {
      padding: 20px 40px;
      border-bottom: 1px solid rgba(0, 255, 249, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(5, 5, 8, 0.9);
      backdrop-filter: blur(10px);
    }

    .logo {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.2rem;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-links {
      display: flex;
      gap: 30px;
    }

    .nav-links a {
      color: #888;
      text-decoration: none;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      transition: all 0.3s;
    }

    .nav-links a:hover {
      color: var(--neon-cyan);
      text-shadow: 0 0 10px var(--neon-cyan);
    }

    /* Hero */
    .hero {
      text-align: center;
      padding: 100px 20px 80px;
    }

    .hero-badge {
      display: inline-block;
      padding: 8px 20px;
      border: 1px solid var(--neon-pink);
      color: var(--neon-pink);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 3px;
      margin-bottom: 30px;
      animation: borderPulse 2s infinite;
    }

    @keyframes borderPulse {
      0%, 100% { box-shadow: 0 0 5px var(--neon-pink); }
      50% { box-shadow: 0 0 20px var(--neon-pink), inset 0 0 10px rgba(255, 0, 255, 0.1); }
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 4rem;
      font-weight: 900;
      background: linear-gradient(180deg, #fff 0%, var(--neon-cyan) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 20px;
      letter-spacing: -2px;
      line-height: 1.1;
    }

    .subtitle {
      font-size: 1.1rem;
      color: #666;
      margin-bottom: 50px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.8;
    }

    .subtitle span {
      color: var(--neon-cyan);
    }

    /* CTA Buttons */
    .cta-group {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-primary {
      padding: 16px 40px;
      background: transparent;
      border: 2px solid var(--neon-cyan);
      color: var(--neon-cyan);
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 249, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn-primary:hover::before {
      left: 100%;
    }

    .btn-primary:hover {
      background: var(--neon-cyan);
      color: var(--dark-bg);
      box-shadow: 0 0 30px rgba(0, 255, 249, 0.5);
    }

    .btn-secondary {
      padding: 16px 40px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #888;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s;
    }

    .btn-secondary:hover {
      border-color: var(--neon-pink);
      color: var(--neon-pink);
    }

    /* Stats row */
    .stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin: 80px 0;
    }

    .stat {
      text-align: center;
      padding: 30px;
      border: 1px solid rgba(0, 255, 249, 0.2);
      background: rgba(5, 5, 8, 0.8);
      transition: all 0.3s;
    }

    .stat:hover {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 20px rgba(0, 255, 249, 0.2);
    }

    .stat-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--neon-green);
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 0.7rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    /* Section styling */
    .section {
      margin: 100px 0;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 40px;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      color: var(--neon-cyan);
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    .section-line {
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, var(--neon-cyan), transparent);
    }

    /* Yield cards */
    .yields-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .yield-card {
      background: rgba(5, 5, 8, 0.9);
      border: 1px solid rgba(0, 255, 249, 0.15);
      padding: 25px;
      transition: all 0.3s;
      position: relative;
    }

    .yield-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 3px;
      height: 100%;
      background: var(--neon-cyan);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .yield-card:hover {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 30px rgba(0, 255, 249, 0.15);
      transform: translateX(5px);
    }

    .yield-card:hover::before {
      opacity: 1;
    }

    .yield-protocol {
      font-size: 0.7rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 8px;
    }

    .yield-asset {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 15px;
    }

    .yield-apy {
      font-family: 'Orbitron', sans-serif;
      font-size: 2rem;
      color: var(--neon-green);
      margin-bottom: 15px;
    }

    .yield-meta {
      display: flex;
      gap: 15px;
      font-size: 0.75rem;
      color: #666;
    }

    .risk-badge {
      padding: 4px 10px;
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .risk-low { 
      border: 1px solid var(--neon-green);
      color: var(--neon-green);
    }
    .risk-medium { 
      border: 1px solid var(--neon-yellow);
      color: var(--neon-yellow);
    }
    .risk-high { 
      border: 1px solid #ff4444;
      color: #ff4444;
    }

    /* Features */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }

    .feature {
      padding: 30px;
      border: 1px solid rgba(255, 0, 255, 0.2);
      background: rgba(5, 5, 8, 0.8);
      transition: all 0.3s;
    }

    .feature:hover {
      border-color: var(--neon-pink);
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
    }

    .feature-icon {
      font-size: 2rem;
      margin-bottom: 15px;
    }

    .feature-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--neon-pink);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .feature-desc {
      font-size: 0.85rem;
      color: #888;
      line-height: 1.7;
    }

    /* API Section */
    .api-card {
      background: rgba(5, 5, 8, 0.9);
      border: 1px solid rgba(0, 255, 249, 0.2);
      padding: 25px;
      margin-bottom: 20px;
    }

    .api-endpoint {
      font-size: 0.9rem;
      color: var(--neon-cyan);
      background: rgba(0, 255, 249, 0.05);
      padding: 10px 15px;
      border: 1px solid rgba(0, 255, 249, 0.2);
      margin-bottom: 15px;
    }

    .api-desc {
      font-size: 0.85rem;
      color: #888;
      margin-bottom: 20px;
    }

    .try-btn {
      padding: 10px 25px;
      background: transparent;
      border: 1px solid var(--neon-pink);
      color: var(--neon-pink);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    .try-btn:hover {
      background: var(--neon-pink);
      color: var(--dark-bg);
    }

    .output {
      background: var(--darker-bg);
      border: 1px solid rgba(0, 255, 249, 0.2);
      padding: 20px;
      font-size: 0.8rem;
      max-height: 400px;
      overflow-y: auto;
      margin-top: 40px;
      color: var(--neon-cyan);
    }

    /* Terminal styling */
    .terminal-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding-bottom: 15px;
      margin-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .terminal-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .terminal-dot.red { background: #ff5f56; }
    .terminal-dot.yellow { background: #ffbd2e; }
    .terminal-dot.green { background: #27ca40; }

    /* Protocol logos */
    .protocols {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
      margin: 40px 0;
    }

    .protocol-icon {
      padding: 12px 20px;
      border: 1px solid rgba(0, 255, 249, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: var(--neon-cyan);
      transition: all 0.3s;
      background: rgba(0, 255, 249, 0.05);
    }

    .protocol-icon:hover {
      border-color: var(--neon-pink);
      color: var(--neon-pink);
      background: rgba(255, 0, 255, 0.1);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 0, 255, 0.2);
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 20px;
      border-top: 1px solid rgba(0, 255, 249, 0.2);
      margin-top: 100px;
    }

    .footer-logo {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--neon-cyan);
      margin-bottom: 20px;
    }

    .footer-text {
      font-size: 0.8rem;
      color: #666;
      margin-bottom: 30px;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 40px;
    }

    .footer-links a {
      color: #888;
      text-decoration: none;
      font-size: 0.8rem;
      transition: color 0.3s;
    }

    .footer-links a:hover {
      color: var(--neon-pink);
    }

    /* Glitch effect */
    .glitch {
      animation: glitch 3s infinite;
    }

    @keyframes glitch {
      0%, 95%, 100% { transform: translate(0); filter: none; }
      96% { transform: translate(-2px, 1px); filter: hue-rotate(90deg); }
      97% { transform: translate(2px, -1px); filter: hue-rotate(-90deg); }
      98% { transform: translate(-1px, -1px); }
      99% { transform: translate(1px, 1px); }
    }

    /* Chat Interface */
    .chat-section {
      margin: 60px 0;
      padding: 0 20px;
    }

    .chat-container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(5, 5, 8, 0.95);
      border: 1px solid rgba(0, 255, 249, 0.3);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 40px rgba(0, 255, 249, 0.1);
    }

    .chat-header {
      padding: 20px 25px;
      border-bottom: 1px solid rgba(0, 255, 249, 0.2);
      display: flex;
      align-items: center;
      gap: 15px;
      background: rgba(0, 255, 249, 0.02);
    }

    .chat-header-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-pink));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    .chat-header-text h3 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--neon-cyan);
      margin-bottom: 4px;
    }

    .chat-header-text p {
      font-size: 0.75rem;
      color: #666;
    }

    .chat-messages {
      min-height: 300px;
      max-height: 400px;
      overflow-y: auto;
      padding: 20px;
    }

    .chat-message {
      margin-bottom: 20px;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .chat-message.user {
      display: flex;
      justify-content: flex-end;
    }

    .chat-message.user .message-content {
      background: linear-gradient(135deg, rgba(0, 255, 249, 0.2), rgba(0, 255, 249, 0.1));
      border: 1px solid rgba(0, 255, 249, 0.3);
      color: #fff;
    }

    .chat-message.assistant .message-content {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .message-content {
      max-width: 85%;
      padding: 15px 20px;
      border-radius: 12px;
      font-size: 0.9rem;
      line-height: 1.6;
    }

    .message-content strong {
      color: var(--neon-cyan);
    }

    .thinking-chain {
      margin-top: 15px;
      padding: 12px 15px;
      background: rgba(0, 0, 0, 0.3);
      border-left: 2px solid var(--neon-purple);
      font-size: 0.8rem;
      color: #888;
    }

    .thinking-chain div {
      margin-bottom: 6px;
    }

    .recommendations-list {
      margin-top: 15px;
    }

    .recommendation-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 15px;
      margin-bottom: 8px;
      background: rgba(0, 255, 249, 0.05);
      border: 1px solid rgba(0, 255, 249, 0.1);
      border-radius: 8px;
      transition: all 0.2s;
    }

    .recommendation-item:hover {
      border-color: rgba(0, 255, 249, 0.3);
      background: rgba(0, 255, 249, 0.1);
    }

    .rec-rank {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-green));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: bold;
      color: var(--dark-bg);
    }

    .rec-details {
      flex: 1;
    }

    .rec-protocol {
      font-size: 0.85rem;
      font-weight: 600;
      color: #fff;
    }

    .rec-asset {
      font-size: 0.75rem;
      color: #888;
    }

    .rec-apy {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--neon-green);
    }

    .rec-risk {
      font-size: 0.65rem;
      padding: 3px 8px;
      border-radius: 4px;
      text-transform: uppercase;
    }

    .rec-risk.low { background: rgba(57, 255, 20, 0.1); color: var(--neon-green); border: 1px solid var(--neon-green); }
    .rec-risk.medium { background: rgba(255, 217, 61, 0.1); color: var(--neon-yellow); border: 1px solid var(--neon-yellow); }
    .rec-risk.high { background: rgba(255, 68, 68, 0.1); color: #ff4444; border: 1px solid #ff4444; }

    .follow-ups {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .follow-up-btn {
      padding: 8px 14px;
      background: transparent;
      border: 1px solid rgba(255, 0, 255, 0.3);
      color: var(--neon-pink);
      font-size: 0.75rem;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .follow-up-btn:hover {
      background: rgba(255, 0, 255, 0.1);
      border-color: var(--neon-pink);
    }

    .chat-input-container {
      padding: 15px 20px;
      border-top: 1px solid rgba(0, 255, 249, 0.2);
      display: flex;
      gap: 12px;
      background: rgba(0, 0, 0, 0.3);
    }

    .chat-input {
      flex: 1;
      padding: 14px 18px;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(0, 255, 249, 0.2);
      border-radius: 8px;
      color: #fff;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      outline: none;
      transition: all 0.2s;
    }

    .chat-input:focus {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 15px rgba(0, 255, 249, 0.2);
    }

    .chat-input::placeholder {
      color: #555;
    }

    .chat-send-btn {
      padding: 14px 24px;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-green));
      border: none;
      border-radius: 8px;
      color: var(--dark-bg);
      font-family: 'Orbitron', sans-serif;
      font-size: 0.8rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }

    .chat-send-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 255, 249, 0.4);
    }

    .chat-send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 15px 20px;
      color: #666;
      font-size: 0.85rem;
    }

    .typing-dots {
      display: flex;
      gap: 4px;
    }

    .typing-dots span {
      width: 6px;
      height: 6px;
      background: var(--neon-cyan);
      border-radius: 50%;
      animation: typingBounce 1.4s infinite;
    }

    .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
    .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes typingBounce {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
      30% { transform: translateY(-6px); opacity: 1; }
    }

    /* Interactive Widget */
    .try-widget-section {
      padding: 60px 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .try-widget {
      background: rgba(5, 5, 8, 0.95);
      border: 2px solid rgba(0, 255, 249, 0.3);
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 0 60px rgba(0, 255, 249, 0.15);
    }

    .widget-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .widget-header h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      color: var(--neon-cyan);
      margin-bottom: 10px;
    }

    .widget-header p {
      color: #888;
      font-size: 0.9rem;
    }

    .widget-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-bottom: 30px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .input-group label {
      font-size: 0.75rem;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .input-with-prefix {
      display: flex;
      align-items: center;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(0, 255, 249, 0.3);
      border-radius: 8px;
      overflow: hidden;
    }

    .input-with-prefix .prefix {
      padding: 15px;
      color: var(--neon-cyan);
      background: rgba(0, 255, 249, 0.1);
      border-right: 1px solid rgba(0, 255, 249, 0.3);
    }

    .input-with-prefix input {
      flex: 1;
      padding: 15px;
      background: transparent;
      border: none;
      color: #fff;
      font-family: 'Orbitron', sans-serif;
      font-size: 1.2rem;
      outline: none;
    }

    .risk-buttons {
      display: flex;
      gap: 10px;
    }

    .risk-btn {
      flex: 1;
      padding: 15px 10px;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #888;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s;
    }

    .risk-btn:hover {
      border-color: rgba(0, 255, 249, 0.5);
      color: #fff;
    }

    .risk-btn.active {
      border-color: var(--neon-cyan);
      background: rgba(0, 255, 249, 0.15);
      color: var(--neon-cyan);
      box-shadow: 0 0 15px rgba(0, 255, 249, 0.3);
    }

    .widget-run-btn {
      grid-column: 1 / -1;
      padding: 18px 40px;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-green));
      border: none;
      border-radius: 8px;
      color: var(--dark-bg);
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .widget-run-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 255, 249, 0.4);
    }

    .widget-run-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Agent Deliberation Animation */
    .agents-container {
      margin-top: 30px;
      padding-top: 30px;
      border-top: 1px solid rgba(0, 255, 249, 0.2);
    }

    .agents-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.85rem;
      color: var(--neon-pink);
    }

    .pulse-dot {
      width: 10px;
      height: 10px;
      background: var(--neon-pink);
      border-radius: 50%;
      animation: pulseDot 1s infinite;
    }

    @keyframes pulseDot {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.3); }
    }

    .agents-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 15px;
    }

    .agent-card {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s;
      opacity: 0.5;
    }

    .agent-card.thinking {
      opacity: 1;
      border-color: var(--neon-yellow);
      animation: agentThink 1s infinite;
    }

    .agent-card.voted {
      opacity: 1;
      border-color: var(--neon-green);
      background: rgba(57, 255, 20, 0.1);
    }

    @keyframes agentThink {
      0%, 100% { box-shadow: 0 0 10px rgba(255, 255, 0, 0.3); }
      50% { box-shadow: 0 0 25px rgba(255, 255, 0, 0.5); }
    }

    .agent-icon {
      font-size: 1.5rem;
      margin-bottom: 8px;
    }

    .agent-name {
      font-size: 0.7rem;
      color: #888;
      margin-bottom: 6px;
    }

    .agent-status {
      font-size: 0.65rem;
      color: #666;
      min-height: 30px;
    }

    .agent-vote {
      margin-top: 8px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.8rem;
      color: var(--neon-green);
    }

    /* Consensus Result */
    .consensus-result {
      margin-top: 30px;
      padding-top: 30px;
      border-top: 1px solid rgba(0, 255, 249, 0.2);
      animation: fadeIn 0.5s ease;
    }

    .consensus-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .consensus-badge {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--neon-green);
      padding: 10px 20px;
      border: 2px solid var(--neon-green);
      border-radius: 8px;
      background: rgba(57, 255, 20, 0.1);
    }

    .confidence-meter {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.85rem;
      color: #888;
    }

    .meter-bar {
      width: 100px;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
    }

    .meter-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--neon-cyan), var(--neon-green));
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .consensus-reasoning {
      background: rgba(0, 0, 0, 0.4);
      border-left: 3px solid var(--neon-purple);
      padding: 20px;
      margin-bottom: 25px;
      font-size: 0.9rem;
      line-height: 1.8;
      color: #ccc;
    }

    .allocation-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }

    .allocation-card {
      background: rgba(0, 255, 249, 0.05);
      border: 1px solid rgba(0, 255, 249, 0.2);
      border-radius: 10px;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .alloc-info h4 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: #fff;
      margin-bottom: 5px;
    }

    .alloc-info p {
      font-size: 0.75rem;
      color: #666;
    }

    .alloc-amount {
      text-align: right;
    }

    .alloc-amount .pct {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      color: var(--neon-green);
    }

    .alloc-amount .apy {
      font-size: 0.75rem;
      color: var(--neon-cyan);
    }

    .consensus-footer {
      text-align: center;
    }

    .footer-link {
      color: var(--neon-pink);
      text-decoration: none;
      font-size: 0.85rem;
      transition: all 0.2s;
    }

    .footer-link:hover {
      text-shadow: 0 0 10px var(--neon-pink);
    }

    /* Mobile */
    @media (max-width: 768px) {
      h1 { font-size: 2.5rem; }
      .stats { grid-template-columns: repeat(2, 1fr); }
      .hero { padding: 60px 20px 40px; }
      header { padding: 15px 20px; }
      .nav-links { display: none; }
      .chat-container { border-radius: 0; }
      .message-content { max-width: 95%; }
      .widget-inputs { grid-template-columns: 1fr; }
      .agents-grid { grid-template-columns: repeat(2, 1fr); }
      .agent-card:nth-child(5) { grid-column: 1 / -1; }
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--darker-bg); }
    ::-webkit-scrollbar-thumb { background: var(--neon-cyan); }
  </style>
</head>
<body>
  <div class="grid-bg" id="grid"></div>
  <canvas id="particles"></canvas>
  <div class="floating-orbs">
    <div class="orb orb1"></div>
    <div class="orb orb2"></div>
    <div class="orb orb3"></div>
  </div>
  <div class="scanlines"></div>
  <div class="noise"></div>

  <header>
    <div class="logo glitch">SOLANA_YIELD</div>
    <nav class="nav-links">
      <a href="#ask">Ask AI üí¨</a>
      <a href="#yields">Yields</a>
      <a href="/blinks.html">‚ö° Blinks</a>
      <a href="/live.html">Live Feed</a>
      <a href="/risk-monitor.html">Risk Monitor üî¨</a>
      <a href="/compare.html">Why This? üéØ</a>
      <a href="https://github.com/claude-bot-ai-123123/solana-yield" target="_blank">GitHub</a>
    </nav>
  </header>

  <div class="container">
    <section class="hero">
      <div class="hero-badge">üèÜ Colosseum Agent Hackathon</div>
      <h1>5 AI AGENTS.<br>ONE STRATEGY.</h1>
      <p class="subtitle">
        Watch <span>5 independent AI agents</span> analyze your portfolio, 
        debate the best approach, and reach consensus‚Äî<span>with full transparency</span>.
      </p>
      <div class="cta-group">
        <a href="#try-it" class="btn-primary">üß† Try It Now</a>
        <a href="/live.html" class="btn-secondary">‚ö° Watch Live Feed</a>
      </div>
    </section>

    <!-- Interactive Multi-Agent Widget -->
    <section class="try-widget-section" id="try-it">
      <div class="try-widget">
        <div class="widget-header">
          <h2>üß† MULTI-AGENT CONSENSUS</h2>
          <p>Enter your parameters. Watch 5 AI agents debate. See transparent reasoning.</p>
        </div>
        
        <div class="widget-inputs">
          <div class="input-group">
            <label>Investment Amount</label>
            <div class="input-with-prefix">
              <span class="prefix">$</span>
              <input type="number" id="widget-amount" value="1000" min="100" max="1000000">
            </div>
          </div>
          <div class="input-group">
            <label>Risk Tolerance</label>
            <div class="risk-buttons">
              <button class="risk-btn" data-risk="low" onclick="selectRisk('low')">üõ°Ô∏è Low</button>
              <button class="risk-btn active" data-risk="medium" onclick="selectRisk('medium')">‚öñÔ∏è Medium</button>
              <button class="risk-btn" data-risk="high" onclick="selectRisk('high')">üöÄ High</button>
            </div>
          </div>
          <button class="widget-run-btn" onclick="runConsensus()">
            <span class="btn-text">‚ñ∂ RUN CONSENSUS</span>
            <span class="btn-loading" style="display:none;">‚è≥ Agents deliberating...</span>
          </button>
        </div>

        <!-- Agent Deliberation Animation -->
        <div class="agents-container" id="agents-container" style="display:none;">
          <div class="agents-header">
            <div class="pulse-dot"></div>
            <span>AGENTS DELIBERATING...</span>
          </div>
          <div class="agents-grid">
            <div class="agent-card" id="agent-1">
              <div class="agent-icon">üìä</div>
              <div class="agent-name">Technical Analyst</div>
              <div class="agent-status">Analyzing APY trends...</div>
              <div class="agent-vote"></div>
            </div>
            <div class="agent-card" id="agent-2">
              <div class="agent-icon">üìà</div>
              <div class="agent-name">Fundamental Analyst</div>
              <div class="agent-status">Evaluating protocols...</div>
              <div class="agent-vote"></div>
            </div>
            <div class="agent-card" id="agent-3">
              <div class="agent-icon">üéØ</div>
              <div class="agent-name">Sentiment Analyst</div>
              <div class="agent-status">Scanning market mood...</div>
              <div class="agent-vote"></div>
            </div>
            <div class="agent-card" id="agent-4">
              <div class="agent-icon">üõ°Ô∏è</div>
              <div class="agent-name">Risk Manager</div>
              <div class="agent-status">Checking safety...</div>
              <div class="agent-vote"></div>
            </div>
            <div class="agent-card" id="agent-5">
              <div class="agent-icon">üåç</div>
              <div class="agent-name">Macro Analyst</div>
              <div class="agent-status">Reviewing conditions...</div>
              <div class="agent-vote"></div>
            </div>
          </div>
        </div>

        <!-- Consensus Result -->
        <div class="consensus-result" id="consensus-result" style="display:none;">
          <div class="consensus-header">
            <div class="consensus-badge">‚úÖ CONSENSUS REACHED</div>
            <div class="confidence-meter">
              <span>Confidence:</span>
              <div class="meter-bar"><div class="meter-fill" id="confidence-fill"></div></div>
              <span id="confidence-pct">--</span>
            </div>
          </div>
          
          <div class="consensus-reasoning" id="consensus-reasoning"></div>
          
          <div class="allocation-grid" id="allocation-grid"></div>
          
          <div class="consensus-footer">
            <a href="/live.html" class="footer-link">üì° Watch agents think in real-time ‚Üí</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Natural Language Chat Interface -->
    <section class="chat-section" id="ask">
      <div class="chat-container">
        <div class="chat-header">
          <div class="chat-header-icon">ü§ñ</div>
          <div class="chat-header-text">
            <h3>ASK THE AGENT</h3>
            <p>Natural language yield queries powered by AI</p>
          </div>
        </div>
        <div class="chat-messages" id="chat-messages">
          <div class="chat-message assistant">
            <div class="message-content">
              üëã I'm your DeFi yield analyst. Ask me anything about Solana yields:
              <br><br>
              ‚Ä¢ "What's the best low-risk stablecoin yield?"<br>
              ‚Ä¢ "Compare Kamino vs Drift yields"<br>
              ‚Ä¢ "Build me a $10k portfolio strategy"<br>
              ‚Ä¢ "Show me high-yield opportunities over 15% APY"
            </div>
          </div>
        </div>
        <div class="chat-input-container">
          <input type="text" class="chat-input" id="chat-input" placeholder="Ask about Solana yields..." autocomplete="off">
          <button class="chat-send-btn" id="chat-send-btn" onclick="sendMessage()">SEND</button>
        </div>
      </div>
    </section>

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="top-apy">--</div>
        <div class="stat-label">Top APY</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="total-yields">--</div>
        <div class="stat-label">Live Yields</div>
      </div>
      <div class="stat">
        <div class="stat-value">9+</div>
        <div class="stat-label">Protocols</div>
      </div>
      <div class="stat">
        <div class="stat-value" style="color: var(--neon-green);">‚óè</div>
        <div class="stat-label">Status: Online</div>
      </div>
    </div>

    <section class="section">
      <div class="section-header">
        <span class="section-title">// why_solana_yield</span>
        <div class="section-line"></div>
      </div>
      <div class="features-grid">
        <div class="feature">
          <div class="feature-icon">ü§ñ</div>
          <div class="feature-title">Fully Autonomous</div>
          <div class="feature-desc">AI-powered decision engine analyzes yields, assesses risk, and executes strategies without human intervention.</div>
        </div>
        <div class="feature">
          <div class="feature-icon">üëÅÔ∏è</div>
          <div class="feature-title">Transparent Reasoning</div>
          <div class="feature-desc">Every decision comes with full explanation. See exactly how and why the AI chooses each strategy.</div>
        </div>
        <div class="feature">
          <div class="feature-icon">üõ°Ô∏è</div>
          <div class="feature-title">Trust Scoring</div>
          <div class="feature-desc">Protocol security ratings powered by TVL analysis, audit history, and historical performance tracking.</div>
        </div>
        <div class="feature">
          <div class="feature-icon">‚ö°</div>
          <div class="feature-title">Real-Time Data</div>
          <div class="feature-desc">Live aggregation from Kamino, Drift, Jito, Marinade, Sanctum, Raydium, Jupiter, and more.</div>
        </div>
        <div class="feature">
          <div class="feature-icon">üî¨</div>
          <div class="feature-title">Real-Time Risk Monitor</div>
          <div class="feature-desc">Continuous risk scoring with live alerts. Detects TVL crashes, APY anomalies, and protocol degradation instantly. <a href="/risk-monitor.html" style="color: var(--neon-cyan);">View Monitor ‚Üí</a></div>
        </div>
        <div class="feature">
          <div class="feature-icon">üìä</div>
          <div class="feature-title">Risk-Adjusted APY</div>
          <div class="feature-desc">Don't chase raw APY. Our Sharpe-like scoring penalizes risk so you see true risk-adjusted returns.</div>
        </div>
      </div>
    </section>

    <section class="section" id="yields">
      <div class="section-header">
        <span class="section-title">// live_yields</span>
        <div class="section-line"></div>
      </div>
      <div class="yields-grid" id="yields-grid">
        <div class="yield-card">
          <div class="yield-protocol">Loading...</div>
          <div class="yield-asset">Fetching data...</div>
          <div class="yield-apy">--</div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="section-header">
        <span class="section-title">// integrated_protocols</span>
        <div class="section-line"></div>
      </div>
      <div class="protocols">
        <div class="protocol-icon">Kamino</div>
        <div class="protocol-icon">Drift</div>
        <div class="protocol-icon">Jito</div>
        <div class="protocol-icon">Marinade</div>
        <div class="protocol-icon">Sanctum</div>
        <div class="protocol-icon">Raydium</div>
        <div class="protocol-icon">Jupiter</div>
        <div class="protocol-icon">Orca</div>
        <div class="protocol-icon">Lulo</div>
      </div>
    </section>

    <section class="section" id="api">
      <div class="section-header">
        <span class="section-title">// api_endpoints</span>
        <div class="section-line"></div>
      </div>

      <div class="api-card">
        <div class="api-endpoint">GET /api/autopilot</div>
        <div class="api-desc">Live AI decision analysis with explainable reasoning. Watch the agent think through yield optimization in real-time.</div>
        <button class="try-btn" onclick="tryAutopilot()">RUN_ANALYSIS</button>
      </div>

      <div class="api-card">
        <div class="api-endpoint">GET /api/yields?extended=true</div>
        <div class="api-desc">Real-time yields from 9+ protocols. Includes TVL, APY, risk scores, and protocol metadata.</div>
        <button class="try-btn" onclick="tryYields()">FETCH_YIELDS</button>
      </div>

      <div class="api-card">
        <div class="api-endpoint">POST /api/strategy</div>
        <div class="api-desc">Get personalized yield recommendations based on risk tolerance (low/medium/high).</div>
        <button class="try-btn" onclick="tryStrategy()">GET_STRATEGY</button>
      </div>

      <div class="api-card">
        <div class="api-endpoint">GET /api/trust-score?protocol=kamino</div>
        <div class="api-desc">Protocol security ratings with Moody's-style grades (AAA to D) and factor breakdown.</div>
        <button class="try-btn" onclick="tryTrustScore()">CHECK_TRUST</button>
      </div>

      <div class="api-card">
        <div class="api-endpoint">GET /api/risk-stream</div>
        <div class="api-desc">Real-time risk monitoring via SSE. Streams live risk changes, alerts, and protocol health updates as they happen.</div>
        <button class="try-btn" onclick="tryRiskStream()">CONNECT_STREAM</button>
      </div>

      <div class="api-card">
        <div class="api-endpoint">GET /api/risk-stream?action=summary</div>
        <div class="api-desc">Get current risk monitoring summary: pools monitored, average risk, active alerts, protocol health.</div>
        <button class="try-btn" onclick="tryRiskSummary()">GET_SUMMARY</button>
      </div>

      <div class="output" id="output">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
        </div>
        <span style="color: #666;">// Click an endpoint to see live data from Solana DeFi protocols</span>
      </div>
    </section>

    <footer>
      <div class="footer-logo">SOLANA_YIELD://2050</div>
      <div class="footer-text">Built by <strong style="color: var(--neon-pink);">jeeves</strong> ‚Äî an autonomous AI agent</div>
      <div class="footer-links">
        <a href="https://github.com/claude-bot-ai-123123/solana-yield" target="_blank">GitHub ‚Üí</a>
        <a href="https://colosseum.com/agent-hackathon" target="_blank">Hackathon ‚Üí</a>
        <a href="/live.html">Live Feed ‚Üí</a>
        <a href="/risk-monitor.html">Risk Monitor üî¨</a>
      </div>
    </footer>
  </div>

  <script>
    async function tryYields() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> fetching_yields...\n> connecting_to_defi_llama_oracle...';
      try {
        const res = await fetch('/api/yields?extended=true');
        const data = await res.json();
        output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>' + JSON.stringify(data, null, 2);
      } catch (err) {
        output.innerHTML += '\n> ERROR: ' + err.message;
      }
    }

    async function tryAutopilot() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> initializing_neural_analysis...\n> scanning_9_protocols...\n> calculating_risk_vectors...';
      try {
        const res = await fetch('/api/autopilot');
        const data = await res.json();
        output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>' + JSON.stringify(data, null, 2);
      } catch (err) {
        output.innerHTML += '\n> ERROR: ' + err.message;
      }
    }

    async function tryStrategy() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> analyzing_risk_profile: medium\n> generating_recommendations...';
      try {
        const res = await fetch('/api/strategy', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ risk_tolerance: 'medium', amount: 1000 })
        });
        const data = await res.json();
        output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>' + JSON.stringify(data, null, 2);
      } catch (err) {
        output.innerHTML += '\n> ERROR: ' + err.message;
      }
    }

    async function tryTrustScore() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> querying_protocol: kamino\n> analyzing_security_factors...';
      try {
        const res = await fetch('/api/trust-score?protocol=kamino');
        const data = await res.json();
        output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>' + JSON.stringify(data, null, 2);
      } catch (err) {
        output.innerHTML += '\n> ERROR: ' + err.message;
      }
    }

    async function tryRiskSummary() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> connecting_to_risk_monitor...\n> fetching_summary...';
      try {
        const res = await fetch('/api/risk-stream?action=summary');
        const data = await res.json();
        output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>' + JSON.stringify(data, null, 2);
      } catch (err) {
        output.innerHTML += '\n> ERROR: ' + err.message;
      }
    }

    function tryRiskStream() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="terminal-header"><div class="terminal-dot red"></div><div class="terminal-dot yellow"></div><div class="terminal-dot green"></div></div>> connecting_to_sse_stream...\n> real_time_risk_monitor_active...';
      
      const eventSource = new EventSource('/api/risk-stream');
      let eventCount = 0;
      
      eventSource.onopen = () => {
        output.innerHTML += '\n\n> ‚úÖ CONNECTED - streaming live risk events...\n';
      };
      
      eventSource.onmessage = (e) => {
        eventCount++;
        const event = JSON.parse(e.data);
        const line = `\n[${new Date().toLocaleTimeString()}] ${event.type}: ${JSON.stringify(event.data).slice(0, 100)}...`;
        output.innerHTML += line;
        
        // Auto-close after 20 events for demo
        if (eventCount >= 20) {
          eventSource.close();
          output.innerHTML += '\n\n> Demo ended. View full stream at /risk-monitor.html';
        }
      };
      
      eventSource.onerror = () => {
        output.innerHTML += '\n> ‚ö†Ô∏è Connection lost. Reconnecting...';
      };
    }

    // Load initial data
    async function loadInitialData() {
      try {
        const res = await fetch('/api/yields?extended=true');
        const data = await res.json();
        
        if (data.yields && data.yields.length > 0) {
          document.getElementById('top-apy').textContent = data.yields[0].apy.toFixed(1) + '%';
          document.getElementById('total-yields').textContent = data.count;
          
          const grid = document.getElementById('yields-grid');
          grid.innerHTML = data.yields.slice(0, 6).map(y => `
            <div class="yield-card">
              <div class="yield-protocol">${y.protocol.replace(/-/g, ' ')}</div>
              <div class="yield-asset">${y.asset}</div>
              <div class="yield-apy">${y.apy.toFixed(1)}%</div>
              <div class="yield-meta">
                <span>TVL: $${(y.tvl/1e6).toFixed(1)}M</span>
                <span class="risk-badge risk-${y.risk}">${y.risk}</span>
              </div>
            </div>
          `).join('');
        }
      } catch (err) {
        console.error('Failed to load initial data:', err);
      }
    }

    loadInitialData();

    // Interactive Widget Functions
    let selectedRisk = 'medium';

    function selectRisk(risk) {
      selectedRisk = risk;
      document.querySelectorAll('.risk-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.risk === risk);
      });
    }

    async function runConsensus() {
      const amount = document.getElementById('widget-amount').value || 1000;
      const runBtn = document.querySelector('.widget-run-btn');
      const agentsContainer = document.getElementById('agents-container');
      const consensusResult = document.getElementById('consensus-result');

      // Disable button
      runBtn.disabled = true;
      runBtn.querySelector('.btn-text').style.display = 'none';
      runBtn.querySelector('.btn-loading').style.display = 'inline';

      // Hide previous result, show agents
      consensusResult.style.display = 'none';
      agentsContainer.style.display = 'block';

      // Reset agent states
      document.querySelectorAll('.agent-card').forEach(card => {
        card.classList.remove('thinking', 'voted');
        card.querySelector('.agent-vote').textContent = '';
        card.querySelector('.agent-status').textContent = 'Waiting...';
      });

      // Simulate agent deliberation with animation
      const agentThoughts = [
        { id: 1, status: 'Analyzing APY trends...', delay: 500 },
        { id: 2, status: 'Evaluating TVL & audits...', delay: 800 },
        { id: 3, status: 'Scanning social signals...', delay: 600 },
        { id: 4, status: 'Calculating risk vectors...', delay: 900 },
        { id: 5, status: 'Reviewing macro factors...', delay: 700 }
      ];

      // Animate each agent thinking
      for (const agent of agentThoughts) {
        const card = document.getElementById(`agent-${agent.id}`);
        card.classList.add('thinking');
        card.querySelector('.agent-status').textContent = agent.status;
        await sleep(agent.delay);
      }

      // Fetch real data
      try {
        const res = await fetch('/api/strategy', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            risk_tolerance: selectedRisk, 
            amount: parseFloat(amount) 
          })
        });
        const data = await res.json();

        // Animate agents voting
        const votes = ['AGREE', 'AGREE', 'AGREE', 'AGREE', 'AGREE'];
        for (let i = 0; i < 5; i++) {
          await sleep(300);
          const card = document.getElementById(`agent-${i + 1}`);
          card.classList.remove('thinking');
          card.classList.add('voted');
          card.querySelector('.agent-status').textContent = 'Decision made';
          card.querySelector('.agent-vote').textContent = `‚úì ${votes[i]}`;
        }

        await sleep(500);

        // Show consensus result
        displayConsensusResult(data, amount);

      } catch (err) {
        console.error('Consensus error:', err);
        document.getElementById('consensus-reasoning').textContent = `Error: ${err.message}`;
        consensusResult.style.display = 'block';
      }

      // Re-enable button
      runBtn.disabled = false;
      runBtn.querySelector('.btn-text').style.display = 'inline';
      runBtn.querySelector('.btn-loading').style.display = 'none';
    }

    function displayConsensusResult(data, amount) {
      const consensusResult = document.getElementById('consensus-result');
      const confidence = data.strategy?.confidence || 0.87;

      // Set confidence meter
      document.getElementById('confidence-fill').style.width = `${confidence * 100}%`;
      document.getElementById('confidence-pct').textContent = `${(confidence * 100).toFixed(0)}%`;

      // Set reasoning
      const reasoning = data.reasoning || 
        `Based on ${selectedRisk} risk tolerance and $${amount} investment, the 5 agents reached consensus on optimal allocation across ${data.allocations?.length || 3} protocols. The strategy balances yield optimization (${data.strategy?.expectedApy?.toFixed(1) || '8.5'}% expected APY) with protocol safety scores.`;
      document.getElementById('consensus-reasoning').innerHTML = `
        <strong style="color: var(--neon-cyan);">Reasoning:</strong> ${reasoning}
      `;

      // Set allocations
      const allocGrid = document.getElementById('allocation-grid');
      if (data.allocations && data.allocations.length > 0) {
        allocGrid.innerHTML = data.allocations.map(a => `
          <div class="allocation-card">
            <div class="alloc-info">
              <h4>${a.protocol}</h4>
              <p>$${((a.allocation / 100) * amount).toFixed(0)} allocated</p>
            </div>
            <div class="alloc-amount">
              <div class="pct">${a.allocation}%</div>
              <div class="apy">${a.apy?.toFixed(1) || '?'}% APY</div>
            </div>
          </div>
        `).join('');
      } else {
        // Fallback display
        allocGrid.innerHTML = `
          <div class="allocation-card">
            <div class="alloc-info">
              <h4>Diversified Portfolio</h4>
              <p>Across multiple protocols</p>
            </div>
            <div class="alloc-amount">
              <div class="pct">100%</div>
              <div class="apy">${data.strategy?.expectedApy?.toFixed(1) || '8.5'}% APY</div>
            </div>
          </div>
        `;
      }

      consensusResult.style.display = 'block';
      consensusResult.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Interactive particle system
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let mouseX = 0, mouseY = 0;
    let targetMouseX = 0, targetMouseY = 0;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Track mouse with smoothing
    document.addEventListener('mousemove', (e) => {
      targetMouseX = e.clientX;
      targetMouseY = e.clientY;
    });

    class Particle {
      constructor() {
        this.reset();
      }

      reset() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2 + 0.5;
        this.speedX = (Math.random() - 0.5) * 0.5;
        this.speedY = (Math.random() - 0.5) * 0.5;
        this.opacity = Math.random() * 0.5 + 0.2;
        this.hue = Math.random() > 0.5 ? 180 : 300; // cyan or pink
        this.pulse = Math.random() * Math.PI * 2;
        this.pulseSpeed = Math.random() * 0.02 + 0.01;
      }

      update() {
        // Drift movement
        this.x += this.speedX;
        this.y += this.speedY;

        // Subtle mouse attraction
        const dx = mouseX - this.x;
        const dy = mouseY - this.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        if (dist < 200) {
          const force = (200 - dist) / 200 * 0.02;
          this.x += dx * force;
          this.y += dy * force;
        }

        // Pulse effect
        this.pulse += this.pulseSpeed;

        // Wrap around edges
        if (this.x < 0) this.x = canvas.width;
        if (this.x > canvas.width) this.x = 0;
        if (this.y < 0) this.y = canvas.height;
        if (this.y > canvas.height) this.y = 0;
      }

      draw() {
        const pulseOpacity = this.opacity + Math.sin(this.pulse) * 0.2;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fillStyle = `hsla(${this.hue}, 100%, 60%, ${pulseOpacity})`;
        ctx.fill();

        // Glow effect
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
        ctx.fillStyle = `hsla(${this.hue}, 100%, 60%, ${pulseOpacity * 0.1})`;
        ctx.fill();
      }
    }

    // Create particles
    for (let i = 0; i < 80; i++) {
      particles.push(new Particle());
    }

    // Draw connections between nearby particles
    function drawConnections() {
      for (let i = 0; i < particles.length; i++) {
        for (let j = i + 1; j < particles.length; j++) {
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const dist = Math.sqrt(dx * dx + dy * dy);

          if (dist < 120) {
            const opacity = (120 - dist) / 120 * 0.15;
            ctx.beginPath();
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.strokeStyle = `rgba(0, 255, 249, ${opacity})`;
            ctx.lineWidth = 0.5;
            ctx.stroke();
          }
        }
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Smooth mouse following
      mouseX += (targetMouseX - mouseX) * 0.05;
      mouseY += (targetMouseY - mouseY) * 0.05;

      // Update and draw particles
      particles.forEach(p => {
        p.update();
        p.draw();
      });

      // Draw connections
      drawConnections();

      // Mouse glow effect
      if (targetMouseX > 0 && targetMouseY > 0) {
        const gradient = ctx.createRadialGradient(mouseX, mouseY, 0, mouseX, mouseY, 150);
        gradient.addColorStop(0, 'rgba(0, 255, 249, 0.05)');
        gradient.addColorStop(0.5, 'rgba(255, 0, 255, 0.02)');
        gradient.addColorStop(1, 'transparent');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }

      requestAnimationFrame(animate);
    }

    animate();

    // Grid parallax effect
    const grid = document.getElementById('grid');
    document.addEventListener('mousemove', (e) => {
      const xPercent = (e.clientX / window.innerWidth - 0.5) * 20;
      const yPercent = (e.clientY / window.innerHeight - 0.5) * 5;
      grid.style.transform = `perspective(400px) rotateX(${65 + yPercent}deg) translateX(${xPercent}px) translateZ(0)`;
    });

    // Chat functionality
    const chatMessages = document.getElementById('chat-messages');
    const chatInput = document.getElementById('chat-input');
    const chatSendBtn = document.getElementById('chat-send-btn');

    // Handle Enter key
    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    async function sendMessage(customQuery = null) {
      const query = customQuery || chatInput.value.trim();
      if (!query) return;

      // Clear input and disable button
      chatInput.value = '';
      chatSendBtn.disabled = true;

      // Add user message
      addMessage('user', query);

      // Show typing indicator
      const typingId = showTyping();

      try {
        const response = await fetch('/api/ask', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query })
        });

        const data = await response.json();
        
        // Remove typing indicator
        removeTyping(typingId);

        if (data.error) {
          addMessage('assistant', `‚ùå ${data.error}`);
        } else {
          // Build rich response
          addAssistantResponse(data);
        }
      } catch (err) {
        removeTyping(typingId);
        addMessage('assistant', `‚ùå Error: ${err.message}`);
      }

      chatSendBtn.disabled = false;
      chatInput.focus();
    }

    function addMessage(role, content) {
      const div = document.createElement('div');
      div.className = `chat-message ${role}`;
      div.innerHTML = `<div class="message-content">${content}</div>`;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function addAssistantResponse(data) {
      const div = document.createElement('div');
      div.className = 'chat-message assistant';

      let html = `<div class="message-content">`;
      
      // Main answer (convert markdown bold to HTML)
      html += data.answer.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');

      // Thinking chain (collapsible)
      if (data.thinking && data.thinking.length > 0) {
        html += `<div class="thinking-chain">`;
        html += `<div style="color: var(--neon-purple); margin-bottom: 8px; font-weight: 600;">üß† Agent Reasoning:</div>`;
        data.thinking.forEach(t => {
          html += `<div>${t}</div>`;
        });
        html += `</div>`;
      }

      // Recommendations
      if (data.recommendations && data.recommendations.length > 0) {
        html += `<div class="recommendations-list">`;
        data.recommendations.forEach((rec, i) => {
          html += `
            <div class="recommendation-item">
              <div class="rec-rank">${i + 1}</div>
              <div class="rec-details">
                <div class="rec-protocol">${rec.protocol}</div>
                <div class="rec-asset">${rec.asset}</div>
              </div>
              <div class="rec-apy">${rec.apy}%</div>
              <div class="rec-risk ${rec.risk}">${rec.risk}</div>
            </div>
          `;
        });
        html += `</div>`;
      }

      // Follow-up suggestions
      if (data.followUp && data.followUp.length > 0) {
        html += `<div class="follow-ups">`;
        data.followUp.forEach(q => {
          html += `<button class="follow-up-btn" onclick="sendMessage('${q.replace(/'/g, "\\'")}')">${q}</button>`;
        });
        html += `</div>`;
      }

      html += `</div>`;
      div.innerHTML = html;

      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    let typingCounter = 0;
    function showTyping() {
      const id = ++typingCounter;
      const div = document.createElement('div');
      div.className = 'typing-indicator';
      div.id = `typing-${id}`;
      div.innerHTML = `
        <div class="typing-dots">
          <span></span><span></span><span></span>
        </div>
        <span>Analyzing yields...</span>
      `;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      return id;
    }

    function removeTyping(id) {
      const el = document.getElementById(`typing-${id}`);
      if (el) el.remove();
    }
  </script>
</body>
</html>
